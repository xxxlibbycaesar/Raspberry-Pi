# 4.Docker

## 4.1 安装

### 4.1.1 脚本安装

```
sudo curl -sSL https://get.docker.com | sh
```

### 4.1.2 apt 安装

```bash
sudo apt-get update												# 更新
sudo apt-get install apt-transport-https \						# 安装 HTTPS 所依赖的包
                       ca-certificates \
                       software-properties-common
curl -fsSL https://yum.dockerproject.org/gpg | sudo apt-key add -	# 添加 Docker 的 GPG key
apt-key fingerprint 58118E89F3A912897C070ADBF76221572C52609D	# 验证 key id:
sudo add-apt-repository \										# 设置稳定的 repository:
       "deb https://apt.dockerproject.org/repo/ \
       raspbian-$(lsb_release -cs) \
       main"
```

注意：如果 add-apt-repository 命令遇到问题，可以尝试将下面这行添加到树莓派软件源 sources.list，操作如下

```bash
vim /etc/apt/sources.list
deb https://apt.dockerproject.org/repo/ raspbian-RELEASE main	# 添加这行
```

查看发行版本

```bash
lsb_release -cs
```

### 4.1.3 docker 安装

```bash
sudo apt-get update
sudo apt-get -y install docker-engine
```

## 4.2 测试 Docker

```bash
sudo docker run hello-world
```

## 4.3 常用配置和工具命令

```bash
#查看 Docker 版本
docker -v
sudo docker pull 仓库/镜像:版本（留空的话默认为 latest）
sudo docker run 加参数，用来创建容器
#查看运行容器
sudo docker ps
#查看所有下载的镜像
sudo docker images
#进入容器终端
sudo docker exec -i -t ha /bin/bash
#实时查看10行的 ha 日志
sudo docker logs -f -t --tail 10 ha
#重启 systemctl 守护进程
sudo systemctl daemon-reload
#设置 Docker 开机启动
sudo systemctl enable docker
#开启 Docker 服务
sudo systemctl start docker
```

## 4.4 Portainer

Portainer：一个Docker可视化界面

### 4.4.1 安装

```bash
#下载 Docker 图形化界面 portainer
sudo docker pull portainer/portainer
#创建 portainer 容器
sudo docker volume create portainer_data
#运行 portainer
sudo docker run -d -p 9000:9000 --name portainer --restart always -v /var/run/docker.sock:/var/run/docker.sock -v portainer_data:/data portainer/portainer
```

成功后访问： http://树莓派IP:9000/

